#!/usr/bin/env python

import argparse
from dmpfold import aln_to_model_fdf, aln_to_model_cns, aln_to_model_xplor

parser = argparse.ArgumentParser(description=("Protein structure prediction with DMPfold2. "
    "See https://github.com/psipred/DMPfold2 for documentation and citation information."))
parser.add_argument("-i", "--input", required=True,
    help="the target sequence and sequence alignment in aln format")
parser.add_argument("-o", "--output", required=True,
    help="the output directory to be created")
parser.add_argument("-p", "--protocol", choices=["fdf", "cns", "xplor"], required=True,
    help="the method for generating models from predicted constraints")
parser.add_argument("-x", "--xplorbindir", default="~/xplor-nih-3.1/bin",
    help="the path to the Xplor-NIH bin directory (xplor protocol only)")
parser.add_argument("-n", "--xplorncpus", default=4,
    help="the number of CPUs to use for Xplor-NIH model generation (xplor protocol only)")

args = parser.parse_args()

if args.protocol == "fdf":
    aln_to_model_fdf(args.input, args.output)
elif args.protocol == "cns":
    aln_to_model_cns(args.input, args.output)
elif args.protocol == "xplor":
    aln_to_model_xplor(args.input, args.output, args.xplorbindir, args.xplorncpus)
